flowchart TB
    AUTH_IN[Authenticated Request] --> API_GW[API Gateway]
    
    subgraph "Conversation Service"
        CONV_API[API Layer]
        CONV_AUTHZ[Tenant Authorization Check]
        CONV_QUERY[Query Handler]
        CONV_CMD[Command Handler]
        CONV_DATA[data store]
        
        CONV_API --> CONV_AUTHZ
        CONV_AUTHZ --> CONV_QUERY
        CONV_AUTHZ --> CONV_CMD
        CONV_QUERY --> CONV_DATA
        CONV_CMD --> CONV_DATA
    end
    
    subgraph "Workflow Service"
        WF_API[API Layer]
        WF_AUTHZ[Tenant Authorization Check]
        WF_QUERY[Query Handler]
        WF_CMD[Command Handler]
        WF_DATA[data store]
        
        WF_API --> WF_AUTHZ
        WF_AUTHZ --> WF_QUERY
        WF_AUTHZ --> WF_CMD
        WF_QUERY --> WF_DATA
        WF_CMD --> WF_DATA
    end
    
    subgraph "Agent Service"
        AGENT_API[API Layer]
        AGENT_AUTHZ[Tenant Authorization Check]
        AGENT_QUERY[Query Handler]
        AGENT_CMD[Command Handler]
        AGENT_DATA[data store]
        
        AGENT_API --> AGENT_AUTHZ
        AGENT_AUTHZ --> AGENT_QUERY
        AGENT_AUTHZ --> AGENT_CMD
        AGENT_QUERY --> AGENT_DATA
        AGENT_CMD --> AGENT_DATA
    end
    
    subgraph "Platform Service"
        PLATFORM_API[API Layer]
        PLATFORM_AUTHZ[Runtime Authorization Engine<br/>Tenant Access Control]
        PLATFORM_QUERY[Query Handler]
        PLATFORM_CMD[Command Handler]
        PLATFORM_MONITOR[Central Control & Monitoring<br/>Collects metrics/logs from all services<br/>Controls runtime behavior & scaling]
        PLATFORM_DATA[data store]
        
        PLATFORM_API --> PLATFORM_AUTHZ
        PLATFORM_AUTHZ --> PLATFORM_QUERY
        PLATFORM_AUTHZ --> PLATFORM_CMD
        PLATFORM_QUERY --> PLATFORM_DATA
        PLATFORM_CMD --> PLATFORM_DATA
        PLATFORM_MONITOR --> PLATFORM_DATA
    end
    
    API_GW --> CONV_API
    API_GW --> WF_API
    API_GW --> AGENT_API
    API_GW --> PLATFORM_API
    
    subgraph "Infrastructure Controllers/Operators"
        subgraph "Database Controller"
            DB_CTRL[PostgreSQL Operator]
            DB_API[Database API<br/>Per-Service Databases]
        end
        
        subgraph "Cache Controller"
            CACHE_CTRL[Redis Operator]
            CACHE_API[Cache API<br/>Per-Service Instances]
        end
        
        subgraph "Storage Controller"
            STORAGE_CTRL[Storage Operator]
            STORAGE_API[Volume API<br/>Per-Service PVCs]
        end
        
        subgraph "LLM Controller"
            LLM_CTRL[LLM Operator]
            LLM_API[Model API<br/>Shared GPU Pool]
        end
    end
    
    EVENT_BUS[Event Bus<br/>Topic/Subscription<br/>Data Stream Service]
    
    subgraph "Infrastructure Access (data stores â†’ Operator APIs)"
        CONV_DATA --> DB_API
        CONV_DATA --> CACHE_API
        CONV_DATA --> STORAGE_API
        
        WF_DATA --> DB_API
        WF_DATA --> CACHE_API
        WF_DATA --> STORAGE_API
        
        AGENT_DATA --> DB_API
        AGENT_DATA --> CACHE_API
        AGENT_DATA --> LLM_API
        
        PLATFORM_DATA --> DB_API
        PLATFORM_DATA --> CACHE_API
    end
    
    subgraph "Inter-Service Events (All Mutations via Event Bus)"
        CONV_CMD <--> EVENT_BUS
        WF_CMD <--> EVENT_BUS
        AGENT_CMD <--> EVENT_BUS
        PLATFORM_CMD <--> EVENT_BUS
    end
    
    subgraph "Cross-Service Tenant Authorization"
        CONV_AUTHZ -.-> PLATFORM_AUTHZ
        WF_AUTHZ -.-> PLATFORM_AUTHZ
        AGENT_AUTHZ -.-> PLATFORM_AUTHZ
    end
    
    
    style AUTH_IN fill:#e1f5fe
    style API_GW fill:#f3e5f5
    style EVENT_BUS fill:#fce4ec
    style DB_API fill:#e3f2fd
    style CACHE_API fill:#f3e5f5
    style LLM_API fill:#fff3e0
    style PLATFORM_MONITOR fill:#ffebee
    style PLATFORM_AUTHZ fill:#f1f8e9
    style CONV_AUTHZ fill:#f1f8e9
    style WF_AUTHZ fill:#f1f8e9
    style AGENT_AUTHZ fill:#f1f8e9