flowchart TD
    subgraph "Phase 2: Queue-Based Asynchronous Processing"
        P2_User["ğŸ‘¤ User Request<br/>Buy 2 iPhones, $2000"]
        P2_User --> P2_LB["âš–ï¸ Load Balancer"]
        P2_LB --> P2_API["ğŸ“± API Server<br/>ğŸ—ï¸ STILL SINGLE DEPLOYMENT<br/>Tech: Java Spring Boot<br/>Team: Single Development Team"]
        
        P2_API --> P2_Queue["ğŸ“® MANAGED MESSAGE QUEUE<br/>AWS SQS / RabbitMQ / Redis<br/>ğŸŒ©ï¸ Platform handles: Persistence, Delivery, Retries"]
        P2_Queue --> P2_Response["âš¡ Immediate Response<br/>Order Queued - Fire & Forget!"]
        P2_Response --> P2_User
        
        subgraph "ğŸ”¥ KEY INSIGHT: Client Decoupling via Platform"
            P2_Queue --> P2_Worker["âš™ï¸ Background Worker Process<br/>Same codebase, different process<br/>Scales independently from API"]
            
            P2_Worker --> P2_S1["ğŸ“¦ Step 1: Validate Inventory<br/>SELECT qty FROM products WHERE id='iPhone'<br/>Result: qty=50 >= 2 âœ…"]
            
            P2_S1 --> P2_S2["ğŸ’³ Step 2: Process Payment<br/>INSERT INTO payments + Call Payment API<br/>Result: $2000 charged âœ…"]
            
            P2_S2 --> P2_S3["ğŸ“‰ Step 3: Update Inventory<br/>UPDATE products SET qty=qty-2 WHERE id='iPhone'<br/>Result: iPhone qty now 48 âœ…"]
            
            P2_S3 --> P2_S4["ğŸ“§ Step 4: Send Notification<br/>INSERT INTO notifications + Call Email API<br/>Result: Email sent âœ…"]
        end
        
        P2_S4 --> P2_DB[("ğŸ—„ï¸ SHARED RDS DATABASE<br/>PostgreSQL / MySQL<br/>Same schema as Phase 1:<br/>â€¢ products table<br/>â€¢ payments table<br/>â€¢ orders table<br/>â€¢ notifications table")]
        
        P2_DB --> P2_Complete["âœ… Async Processing Complete<br/>User notified via email"]
        
        subgraph "ğŸ¯ PHASE 2 KEY BREAKTHROUGH"
            P2_Insight["ğŸ’¡ Async Benefits via Platform:<br/>â€¢ Client responsiveness improved<br/>â€¢ Queue platform handles reliability<br/>â€¢ Worker can retry failed operations<br/>â€¢ Better resource utilization<br/>â€¢ Still single codebase/deployment<br/>â€¢ Worker becomes new bottleneck"]
        end
    end